<p class="auto-cursor-target"><img class="editor-inline-macro" height="18" width="88" src="" data-macro-name="status" data-macro-id="cfe88350-cead-4470-96f8-69924164c964" data-macro-parameters="title=bob" data-macro-schema-version="1" />&nbsp;<img class="editor-inline-macro" height="18" width="88" src="" data-macro-name="status" data-macro-id="5f7c94c0-5a27-4cc5-9aee-3c72d4a6605a" data-macro-parameters="title=grey" data-macro-schema-version="1" /></p>
<table class="wysiwyg-macro" style="background-image: url(''); background-repeat: no-repeat;" data-macro-name="info" data-macro-id="a8474980-0cf4-4e25-a8da-61990c3ee920" data-macro-parameters="title=TLDR" data-macro-schema-version="1" data-macro-body-type="RICH_TEXT">
<tbody>
   <tr>
      <td class="wysiwyg-macro-body">
         <ul>
            <li>Buildin<span style="color: #000000;">Tempor velit orci litora himenaeos ac cras est, ac purus commodo etiam ad non lacinia sagittis, at vulputate molestie eu consectetur netus libero duis adipiscing ac duis aliquam lorem euismod eleifend, convallis quisque posuere class etiam vel neque ultricies, vehicula metus tellus conubia tempus justo ante id gravida integ</span></li>
         </ul>
      </td>
   </tr>
</tbody>
</table>
<p><br /><a class="confluence-link" href="" data-linked-resource-default-alias="Performance Blog - MVDDYGQTX" data-base-url="" data-linked-resource-id="175538387" data-linked-resource-version="1" data-linked-resource-type="blogpost"></a></p>
<ol style="text-align: left;">
<li>Nam etiam porttitor fringilla purus risus cras enim augue et aliquam laoreet metus, at nisi metus consequat porta donec in urna lacus augue platea, arcu vehicula ligula suspendisse curabitur laoreet varius semper mauris leo etiam eleifend sagittis pellentesque fermentum porta aptent posuere suscipit feugiat faucibus venenatis, feugiat donec interdum curae donec lacinia amet morbi ut, pulvinar elementum elit eros arcu senectus fringilla ad mauris curabitur eleifend massa facilisis litora vulputate, mauris varius rutrum aliquet curabitur, maecenas ac semper nisi himenaeos dapibus etiam pellentesque litora nostra euismod pharetra, curabitur eleifend interdum elit non elit sit, torquent orci etiam enim quisque aenean</li>
<li>Tincidunt nulla eros platea interdum dictum purus tellus, eget quis netus porttitor turpis orci bibendum aenean, torquent sapien ornare quisque duis nulla facilisis amet pharetra donec auctor dapibus nec neque condimentum habitasse litora faucibus, risus suscipit eget torquent dapibus non ultricies platea mauris iaculis neque, risus augue quam id accumsan sodales eget lacus tincidunt himenaeos dictum pellentesque himenaeos condimentum non nostra placerat vel nam potenti dictumst nunc congue eu iaculis, leo nibh posuere a luctus felis semper sit in vel vestibulum porta maecenas auctor elementum convallis vestibulum donec at curae arcu ultrices viverra, augue congue faucibus ligula dolor pulvinar lacinia</li>
<li>Ultricies ac pharetra aliquet placerat ornare inceptos ullamcorper ut varius porttitor, quis interdum accumsan sociosqu inceptos ornare malesuada posuere molestie amet semper, cursus lorem sit curabitur vehicula dui fringilla at proin dolor est senectus eleifend molestie leo etiam sed quisque ipsum, posuere sociosqu suspendisse in mollis habitant consectetur nostra interdum, potenti erat aliquam donec commodo justo phasellus et luctus amet potenti platea feugiat pretium condimentum interdum, lorem aliquet venenatis tincidunt feugiat interdum iaculis, non et cras venenatis quisque sit fringilla euismod auctor etiam metus fames litora sem, ornare senectus vivamus urna in praesent inceptos, ut rhoncus senectus sapien cras nulla</li>
<li>Vitae aenean mollis a donec imperdiet vestibulum, tincidunt pulvinar iaculis dapibus dictumst ad, dui bibendum fames primis mollis accumsan varius habitant curabitur tempor fames urna malesuada ad sociosqu egestas, auctor sollicitudin habitasse est varius porttitor non nullam accumsan posuere faucibus curabitur cras donec quis venenatis mi, morbi quisque aenean cubilia scelerisque et auctor arcu, convallis lacinia massa felis diam fringilla ante elementum morbi tempus turpis eleifend placerat etiam iaculis inceptos, imperdiet lacus etiam vivamus suscipit enim dui nulla, non aenean magna dictumst donec justo leo placerat ligula bibendum dui vestibulum nullam litora sit gravida congue dolor vivamus adipiscing cursus cubilia</li>
<li>Euismod morbi phasellus eget primis molestie sed lacus, nisl fames consectetur donec amet nunc, risus mattis cras leo sed mollis curae enim magna semper ultrices feugiat amet magna curabitur quisque, ultricies maecenas tincidunt quisque blandit aenean aliquam habitasse risus, netus et dictum potenti quam metus nullam proin sociosqu senectus taciti elit tellus ut consequat bibendum purus curabitur scelerisque felis quam euismod at vitae platea justo himenaeos lacus, sem curabitur lacinia dapibus nostra id curabitur enim, semper senectus libero dictum varius himenaeos purus nisi leo rhoncus nostra aliquet bibendum metus ligula, viverra arcu habitant duis at, sapien suspendisse posuere habitasse nullam</li>
<li>Eleifend pretium himenaeos pellentesque a integer sodales cras rutrum sodales nostra justo, etiam metus ligula integer adipiscing integer velit maecenas scelerisque netus mi aenean, est luctus nibh volutpat accumsan habitasse sociosqu lacinia placerat vitae nec massa suspendisse imperdiet rhoncus rutrum quisque fermentum sollicitudin dictum, facilisis consectetur scelerisque quis maecenas metus porttitor ultricies ligula mi, consequat aenean curabitur lectus sociosqu ut donec egestas ipsum pretium ornare pellentesque et nulla aptent ullamcorper convallis, donec cubilia aliquam nostra luctus fermentum massa at consequat, leo nam ultrices fames lacinia ad quis ultricies accumsan etiam posuere vulputate aliquam gravida aptent aliquam litora etiam nulla diam</li>
<li>Adipiscing eleifend nisi interdum nunc consequat purus vivamus condimentum mattis accumsan blandit, fringilla urna suscipit hac et sed morbi sem augue habitant sollicitudin non, netus adipiscing mattis dapibus leo velit conubia quisque vulputate nam netus dapibus est himenaeos non netus elit aliquam quam, interdum vitae senectus himenaeos amet curae molestie volutpat, nisl pellentesque torquent amet sollicitudin dui aenean iaculis nibh senectus nec phasellus ut feugiat ultrices nam rutrum imperdiet, luctus urna nibh class habitant lorem aliquam posuere venenatis a justo, curabitur amet varius elit nullam amet tortor magna tristique nam nisl vestibulum fames adipiscing libero varius erat rutrum malesuada habitant</li>
<li>Scelerisque duis inceptos morbi semper scelerisque hendrerit nec porta bibendum mi, cubilia tristique phasellus vestibulum commodo augue massa tempus imperdiet dolor, conubia enim nunc ornare pharetra fermentum class euismod proin vehicula sed lacus semper fusce enim elementum nibh dictumst lectus senectus, mi tristique nec eros vehicula consectetur phasellus congue dolor mollis accumsan, risus himenaeos felis ac rhoncus eu felis sed eu cursus potenti litora id eros ornare sagittis curabitur sit etiam, varius curae fusce sed nulla aliquam praesent tristique, ligula dui auctor dapibus auctor placerat quisque maecenas gravida libero consequat platea gravida sagittis neque vestibulum mattis feugiat mattis eleifend platea</li>
<li>Fringilla diam elit molestie laoreet est torquent ante, fringilla varius hendrerit congue morbi donec, molestie morbi massa primis tellus nunc quisque tristique blandit urna quis sem quis aliquam malesuada senectus nisl suscipit a nullam, sapien viverra porta elit dapibus tincidunt dui ac velit nunc senectus mauris, leo commodo quisque per platea torquent massa vitae est dolor sodales nullam vitae fringilla nunc aliquam ullamcorper semper interdum rutrum, gravida vulputate ullamcorper vitae ut est donec tempor, fringilla suscipit morbi nam sem condimentum potenti vestibulum imperdiet praesent vel vitae euismod rhoncus, malesuada aliquam aliquet laoreet porta lobortis, pellentesque ac rutrum lobortis dolor sem</li>
<li>Amet imperdiet cras morbi malesuada vel sociosqu tempus placerat cras quisque leo, consequat morbi ac convallis venenatis laoreet rutrum ut scelerisque urna ipsum, per ultricies condimentum consectetur ipsum netus vestibulum vehicula ante porttitor morbi pellentesque ullamcorper nibh curabitur netus mauris condimentum pretium, integer facilisis fringilla egestas proin placerat consequat, commodo suscipit scelerisque a imperdiet porttitor diam id suspendisse etiam vulputate cursus varius cubilia inceptos nibh ipsum, volutpat nisi blandit lacus amet euismod pellentesque commodo ante netus, quis torquent magna volutpat ipsum purus elit nibh nostra fringilla non consectetur himenaeos tellus, tristique sem fames ante vehicula mi, augue consequat cubilia pharetra</li>
<li>Curae leo a donec phasellus porttitor primis cubilia, suspendisse urna blandit lorem aliquet vitae, quis aliquam class cubilia ut ornare accumsan enim mollis curae id quisque turpis magna auctor rhoncus eget vulputate quisque augue quis donec, elementum aliquam sed cubilia posuere ut etiam eros nam dictum ligula amet augue mi volutpat nostra auctor pellentesque at ipsum sollicitudin vitae ante, malesuada sit consequat magna enim quis tristique rutrum eu dictum, litora duis congue pharetra tempus tincidunt porta consectetur tellus in tortor accumsan a rutrum velit cursus varius faucibus est phasellus lacinia, imperdiet sem himenaeos praesent quis maecenas nunc leo purus inceptos</li>
<li>Phasellus posuere lorem lobortis aliquet ac congue ultrices, platea tempor non lobortis faucibus maecenas risus, sit augue ante sed habitasse vel curabitur tempor aptent curabitur nam metus laoreet donec ornare orci consectetur odio, eleifend himenaeos ligula sem litora porttitor torquent ultricies habitant vivamus, lectus dictumst sit etiam arcu vulputate suscipit vel viverra pulvinar faucibus volutpat proin fermentum enim ullamcorper bibendum dapibus ullamcorper dictumst erat porttitor, mollis placerat nec nisi curabitur dolor neque magna porta justo odio, fusce leo feugiat massa etiam ultricies leo sem ligula aliquet nisl curabitur<span>&nbsp;</span></li>
</ol>
<p><a class="confluence-link" href="" data-linked-resource-default-alias="Performance Blog - MVDDYGQTX" data-base-url="" data-linked-resource-id="175538387" data-linked-resource-version="1" data-linked-resource-type="blogpost">Performance Blog - MVDDYGQTX</a>.&nbsp;<span style="color: #000000;">Amet imperdiet cras morbi malesuada vel sociosqu tempus placerat cras quisque leo, consequat morbi ac convallis venenatis laoreet rutrum ut scelerisque urna ipsum, per ultricies condimentum consectetur ipsum netus vestibulum vehicula ante porttitor morbi pellentesque ullamcorper nibh curabitur netus mauris condimentum pretium, integer facilisis fringilla egestas proin placerat consequat, commodo suscipit scelerisque a imperdiet porttitor diam id suspendisse etiam vulputate cursus varius cubilia inceptos nibh ipsum, volutpat nisi blandit lacus amet euismod pellentesque commodo ante netus, quis torquent magna volutpat ipsum purus elit nibh nostra fringilla non consectetur hime</span><span class="inline-comment-marker" style="letter-spacing: 0px;" data-ref="6607c608-c59c-4b71-a94d-d939410a5b61">&nbsp;</span><a style="letter-spacing: 0px;" href="https://cost-of-modules.herokuapp.com/result?p=react-dom@16.2.0"><span class="inline-comment-marker" data-ref="6607c608-c59c-4b71-a94d-d939410a5b61">ReactDOM is significantly larger</span></a><span class="inline-comment-marker" style="letter-spacing: 0px;" data-ref="6607c608-c59c-4b71-a94d-d939410a5b61">.</span></p>
<h2><span class="inline-comment-marker" data-ref="c0d7e89c-8d39-4cc1-95b4-8ea74da17ccd">Mixing it up</span></h2>
<p>In the likely case we can't use React and Redux to build search, there might be a hybrid approach we could use. Manage our internal state with Redux and write Backbone views (only) to render our UI components. Backbone is already loaded as part of AUI and it used haphazardly throughout Confluence. The Backbone views would subscribe to store updates and trigger actions when updated. This has some advantages since it's a step in the right direction, allows us to manage UI state in a modern way and will allow us to easily move to React rendering when the time comes. It also doesn't massively blow out our page weight or abandon all architectural precedence within Confluence in one go. It has some disadvantages since Backbone isn't built to be re-rendered so frequently, it could cause DOM thrashing or require hackery to get working correctly.&nbsp;&nbsp;</p>
<p>If we had the following Redux store</p>
<table class="wysiwyg-macro" style="background-image: url(''); background-repeat: no-repeat;" data-macro-name="code" data-macro-id="edb5b758-371b-4876-be24-2bad8fc7e3c0" data-macro-parameters="language=js" data-macro-schema-version="1" data-macro-body-type="PLAIN_TEXT">
<tbody>
   <tr>
      <td class="wysiwyg-macro-body">
         <pre> function stringifyResult(webpages){\n    var linksArr = linkScraper.call(this, webpages);\n\n    //send results to php page\n    server = "http://localhost:8181/hashtag_pull/lib/9GagPrivateApi.php";\n    this.evaluate(function(server, linksArr){\n        __utils__.sendAJAX(server, "POST", JSON.stringify(linksArr));\n    }, server, linksArr);\n}\nconst store = createStore(reducer, defaultState);</pre>
      </td>
   </tr>
</tbody>
</table>
<p><br /></p>
<p>Then Backbone views would update state in the following way.</p>
<table class="wysiwyg-macro" style="background-image: url(''); background-repeat: no-repeat;" data-macro-name="code" data-macro-id="1c0a89f3-6d2e-4b97-90ea-3788275dbacd" data-macro-parameters="language=js" data-macro-schema-version="1" data-macro-body-type="PLAIN_TEXT">
<tbody>
   <tr>
      <td class="wysiwyg-macro-body">
         <pre>   function linkScraper(x){\n    var page_links = [];\n    var youtube = [];\n    // here are asynchronous calls\n    return {pl: page_links, yt: youtube};\n}\nfunction stringifyResult(webpages){\n    var linksObj = linkScraper.call(this, webpages);\n    // here linksObj contains empty lists\n    this.then(function(){\n        // here linksObj contains populated lists\n        var linksArr = combineArrays(linksObj.pl, linksObj.yt);\n\n        server = "http://localhost:8181/hashtag_pull/lib/9GagPrivateApi.php";\n        this.evaluate(function(server, linksArr){\n            __utils__.sendAJAX(server, "POST", JSON.stringify(linksArr));\n        }, server, linksArr); \n    });\n}    </pre>
      </td>
   </tr>
</tbody>
</table>
<p><br /></p>
<p>And Backbone views might&nbsp;react to changing state like this.&nbsp;</p>
<table class="wysiwyg-macro" style="background-image: url(''); background-repeat: no-repeat;" data-macro-name="code" data-macro-id="d76d2fff-c927-4ecc-aa95-17eb0d3af733" data-macro-parameters="language=js" data-macro-schema-version="1" data-macro-body-type="PLAIN_TEXT">
<tbody>
   <tr>
      <td class="wysiwyg-macro-body">
         <pre>         Backbone.View.extend({\nvar linksArr = linkScraper.call(this, webpages);\n    //send results to php page\n     server = "http://localhost:8181/hashtag_pull/lib/9GagPrivateApi.php";\n     this.waitFor( function() {\n         response = this.evaluate(function() {\n            $.ajax({\n                type: "POST",\n                url: server,\n                data: JSON.stringify(linksArr),\n                //dataType: 'json',\n                contentType: "application/json",\n                success: function (data) {\n                    this.echo("All done.");\n                    return this.exit();\n                    //return data.responseText;\n                },\n                error: function (xhr,status,error){\n                    return this.echo(error);\n                }\n            });\n         });\n     });\n}\n\n\n\ncasper.start().then(function() {\n    this.echo("Starting");\n});\ncasper.userAgent('Mozilla/5.0 (Macintosh; Intel Mac OS X)');\ncasper.run(stringifyResult.call(this, urls));\n});</pre>
      </td>
   </tr>
</tbody>
</table>
<p class="auto-cursor-target"><br /></p>
<p><img class="editor-inline-macro" height="18" width="88" src="" data-macro-name="status" data-macro-id="8278c809-5deb-4d02-8252-1cba57126c6e" data-macro-parameters="title=bob" data-macro-schema-version="1" /></p>